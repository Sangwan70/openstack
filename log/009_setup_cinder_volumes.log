Success. Node compute in mgmt: 10.0.0.31.
IP address of this node's interface in management network: 10.0.0.31.
Installing qemu support package for non-raw image types.
Last metadata expiration check: 1:18:05 ago on Mon 28 Dec 2020 12:37:01 AM EST.
Package qemu-kvm-15:5.1.0-14.el8.1.x86_64 is already installed.
Package lvm2-8:2.03.09-5.el8.x86_64 is already installed.
Dependencies resolved.
Nothing to do.
Complete!
Configuring LVM physical and logical volumes.
  Physical volume "/dev/sdd" successfully created.
  Volume group "cinder-volumes" successfully created
Setting LVM filter line in /etc/lvm/lvm.conf to only allow /dev/sdd.
Verifying LVM filter.
	filter = [ "a/sdd/", "r/.*/"]
Installing cinder.
Last metadata expiration check: 1:18:06 ago on Mon 28 Dec 2020 12:37:01 AM EST.
Package targetcli-2.1.53-1.el8.noarch is already installed.
Dependencies resolved.
================================================================================
 Package                    Arch    Version           Repository           Size
================================================================================
Installing:
 openstack-cinder           noarch  1:17.0.0-1.el8    openstack-victoria   61 k
Installing dependencies:
 python3-cinder             noarch  1:17.0.0-1.el8    openstack-victoria  7.4 k
 python3-cinder-common      noarch  1:17.0.0-1.el8    openstack-victoria  3.9 M
 python3-etcd3gw            noarch  0.2.5-1.el8       openstack-victoria   41 k
 python3-google-api-client  noarch  1:1.6.7-10.el8    openstack-victoria   97 k
 python3-oauth2client       noarch  4.1.3-8.el8       openstack-victoria  149 k
 python3-swiftclient        noarch  3.10.1-2.el8      openstack-victoria  175 k
 python3-tabulate           noarch  0.8.7-4.el8       openstack-victoria   50 k
 python3-uritemplate        noarch  3.0.0-10.el8      openstack-victoria   23 k
 python3-zstd               x86_64  1.4.5.1-1.el8     openstack-victoria   18 k

Transaction Summary
================================================================================
Install  10 Packages

Total download size: 4.5 M
Installed size: 20 M
Downloading Packages:
(1/10): python3-cinder-17.0.0-1.el8.noarch.rpm   61 kB/s | 7.4 kB     00:00    
(2/10): openstack-cinder-17.0.0-1.el8.noarch.rp 321 kB/s |  61 kB     00:00    
(3/10): python3-etcd3gw-0.2.5-1.el8.noarch.rpm  434 kB/s |  41 kB     00:00    
(4/10): python3-google-api-client-1.6.7-10.el8. 631 kB/s |  97 kB     00:00    
(5/10): python3-oauth2client-4.1.3-8.el8.noarch 1.1 MB/s | 149 kB     00:00    
(6/10): python3-tabulate-0.8.7-4.el8.noarch.rpm 628 kB/s |  50 kB     00:00    
(7/10): python3-swiftclient-3.10.1-2.el8.noarch 1.6 MB/s | 175 kB     00:00    
(8/10): python3-uritemplate-3.0.0-10.el8.noarch 375 kB/s |  23 kB     00:00    
(9/10): python3-zstd-1.4.5.1-1.el8.x86_64.rpm   364 kB/s |  18 kB     00:00    
(10/10): python3-cinder-common-17.0.0-1.el8.noa 2.7 MB/s | 3.9 MB     00:01    
--------------------------------------------------------------------------------
Total                                           2.5 MB/s | 4.5 MB     00:01     
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Preparing        :                                                        1/1 
  Installing       : python3-oauth2client-4.1.3-8.el8.noarch               1/10 
  Installing       : python3-zstd-1.4.5.1-1.el8.x86_64                     2/10 
  Installing       : python3-uritemplate-3.0.0-10.el8.noarch               3/10 
  Installing       : python3-google-api-client-1:1.6.7-10.el8.noarch       4/10 
  Installing       : python3-tabulate-0.8.7-4.el8.noarch                   5/10 
  Installing       : python3-cinder-common-1:17.0.0-1.el8.noarch           6/10 
  Installing       : python3-swiftclient-3.10.1-2.el8.noarch               7/10 
  Installing       : python3-etcd3gw-0.2.5-1.el8.noarch                    8/10 
  Installing       : python3-cinder-1:17.0.0-1.el8.noarch                  9/10 
  Running scriptlet: openstack-cinder-1:17.0.0-1.el8.noarch               10/10 
  Installing       : openstack-cinder-1:17.0.0-1.el8.noarch               10/10 
  Running scriptlet: openstack-cinder-1:17.0.0-1.el8.noarch               10/10 
  Verifying        : openstack-cinder-1:17.0.0-1.el8.noarch                1/10 
  Verifying        : python3-cinder-1:17.0.0-1.el8.noarch                  2/10 
  Verifying        : python3-cinder-common-1:17.0.0-1.el8.noarch           3/10 
  Verifying        : python3-etcd3gw-0.2.5-1.el8.noarch                    4/10 
  Verifying        : python3-google-api-client-1:1.6.7-10.el8.noarch       5/10 
  Verifying        : python3-oauth2client-4.1.3-8.el8.noarch               6/10 
  Verifying        : python3-swiftclient-3.10.1-2.el8.noarch               7/10 
  Verifying        : python3-tabulate-0.8.7-4.el8.noarch                   8/10 
  Verifying        : python3-uritemplate-3.0.0-10.el8.noarch               9/10 
  Verifying        : python3-zstd-1.4.5.1-1.el8.x86_64                    10/10 

Installed:
  openstack-cinder-1:17.0.0-1.el8.noarch                                        
  python3-cinder-1:17.0.0-1.el8.noarch                                          
  python3-cinder-common-1:17.0.0-1.el8.noarch                                   
  python3-etcd3gw-0.2.5-1.el8.noarch                                            
  python3-google-api-client-1:1.6.7-10.el8.noarch                               
  python3-oauth2client-4.1.3-8.el8.noarch                                       
  python3-swiftclient-3.10.1-2.el8.noarch                                       
  python3-tabulate-0.8.7-4.el8.noarch                                           
  python3-uritemplate-3.0.0-10.el8.noarch                                       
  python3-zstd-1.4.5.1-1.el8.x86_64                                             

Complete!
Configuring /etc/cinder/cinder.conf.
Setting database connection: mysql+pymysql://cinder:cinderDBPass@controller/cinder.
'/etc/cinder/cinder.conf' -> '/tmp/057_etc_cinder_cinder.conf.iniset'
iniset /tmp/057_etc_cinder_cinder.conf.iniset database connection mysql+pymysql://cinder:cinderDBPass@controller/cinder
Configuring RabbitMQ message queue access.
'/etc/cinder/cinder.conf' -> '/tmp/058_etc_cinder_cinder.conf.iniset'
iniset /tmp/058_etc_cinder_cinder.conf.iniset DEFAULT transport_url rabbit://openstack:rabbitPass@controller
'/etc/cinder/cinder.conf' -> '/tmp/059_etc_cinder_cinder.conf.iniset'
iniset /tmp/059_etc_cinder_cinder.conf.iniset DEFAULT auth_strategy keystone
'/etc/cinder/cinder.conf' -> '/tmp/060_etc_cinder_cinder.conf.iniset'
iniset /tmp/060_etc_cinder_cinder.conf.iniset keystone_authtoken www_authenticate_uri http://controller:5000
'/etc/cinder/cinder.conf' -> '/tmp/061_etc_cinder_cinder.conf.iniset'
iniset /tmp/061_etc_cinder_cinder.conf.iniset keystone_authtoken auth_url http://controller:5000
'/etc/cinder/cinder.conf' -> '/tmp/062_etc_cinder_cinder.conf.iniset'
iniset /tmp/062_etc_cinder_cinder.conf.iniset keystone_authtoken memcached_servers controller:11211
'/etc/cinder/cinder.conf' -> '/tmp/063_etc_cinder_cinder.conf.iniset'
iniset /tmp/063_etc_cinder_cinder.conf.iniset keystone_authtoken auth_type password
'/etc/cinder/cinder.conf' -> '/tmp/064_etc_cinder_cinder.conf.iniset'
iniset /tmp/064_etc_cinder_cinder.conf.iniset keystone_authtoken project_domain_id default
'/etc/cinder/cinder.conf' -> '/tmp/065_etc_cinder_cinder.conf.iniset'
iniset /tmp/065_etc_cinder_cinder.conf.iniset keystone_authtoken user_domain_id default
'/etc/cinder/cinder.conf' -> '/tmp/066_etc_cinder_cinder.conf.iniset'
iniset /tmp/066_etc_cinder_cinder.conf.iniset keystone_authtoken project_name service
'/etc/cinder/cinder.conf' -> '/tmp/067_etc_cinder_cinder.conf.iniset'
iniset /tmp/067_etc_cinder_cinder.conf.iniset keystone_authtoken username cinder
'/etc/cinder/cinder.conf' -> '/tmp/068_etc_cinder_cinder.conf.iniset'
iniset /tmp/068_etc_cinder_cinder.conf.iniset keystone_authtoken password cinderPass
'/etc/cinder/cinder.conf' -> '/tmp/069_etc_cinder_cinder.conf.iniset'
iniset /tmp/069_etc_cinder_cinder.conf.iniset DEFAULT target_helper lioadm
'/etc/cinder/cinder.conf' -> '/tmp/070_etc_cinder_cinder.conf.iniset'
iniset /tmp/070_etc_cinder_cinder.conf.iniset backend_defaults target_helper lioadm
'/etc/cinder/cinder.conf' -> '/tmp/071_etc_cinder_cinder.conf.iniset'
iniset /tmp/071_etc_cinder_cinder.conf.iniset lvm volume_driver cinder.volume.drivers.lvm.LVMVolumeDriver
'/etc/cinder/cinder.conf' -> '/tmp/072_etc_cinder_cinder.conf.iniset'
iniset /tmp/072_etc_cinder_cinder.conf.iniset lvm volume_group cinder-volumes
'/etc/cinder/cinder.conf' -> '/tmp/073_etc_cinder_cinder.conf.iniset'
iniset /tmp/073_etc_cinder_cinder.conf.iniset lvm target_ip_address 10.0.0.31
'/etc/cinder/cinder.conf' -> '/tmp/074_etc_cinder_cinder.conf.iniset'
iniset /tmp/074_etc_cinder_cinder.conf.iniset lvm iscsi_protocol iscsi
'/etc/cinder/cinder.conf' -> '/tmp/075_etc_cinder_cinder.conf.iniset'
iniset /tmp/075_etc_cinder_cinder.conf.iniset lvm iscsi_helper lioadm
'/etc/cinder/cinder.conf' -> '/tmp/076_etc_cinder_cinder.conf.iniset'
iniset /tmp/076_etc_cinder_cinder.conf.iniset DEFAULT target_ip_address 10.0.0.31
'/etc/cinder/cinder.conf' -> '/tmp/077_etc_cinder_cinder.conf.iniset'
iniset /tmp/077_etc_cinder_cinder.conf.iniset DEFAULT enable_v3_api True
'/etc/cinder/cinder.conf' -> '/tmp/078_etc_cinder_cinder.conf.iniset'
iniset /tmp/078_etc_cinder_cinder.conf.iniset DEFAULT state_path /var/lib/cinder
'/etc/cinder/cinder.conf' -> '/tmp/079_etc_cinder_cinder.conf.iniset'
iniset /tmp/079_etc_cinder_cinder.conf.iniset DEFAULT volumes_dir /var/lib/cinder
'/etc/cinder/cinder.conf' -> '/tmp/080_etc_cinder_cinder.conf.iniset'
iniset /tmp/080_etc_cinder_cinder.conf.iniset DEFAULT enabled_backends lvm
'/etc/cinder/cinder.conf' -> '/tmp/081_etc_cinder_cinder.conf.iniset'
iniset /tmp/081_etc_cinder_cinder.conf.iniset DEFAULT glance_api_servers http://controller:9292
'/etc/cinder/cinder.conf' -> '/tmp/082_etc_cinder_cinder.conf.iniset'
iniset /tmp/082_etc_cinder_cinder.conf.iniset oslo_concurrency lock_path /var/lib/cinder/tmp
Restarting cinder service.
Created symlink /etc/systemd/system/multi-user.target.wants/openstack-cinder-volume.service → /usr/lib/systemd/system/openstack-cinder-volume.service.
module iscsiadm 1.0;

require {
        type iscsid_t;
        class capability dac_override;
}

#============= iscsid_t ==============
allow iscsid_t self:capability dac_override;
success
success
Verifying Block Storage installation on controller node.
Sourcing the admin credentials.
Restarting restarting cinder-scheduler.
ssh controller sudo systemctl restart openstack-cinder-api
ssh controller sudo systemctl restart openstack-cinder-scheduler
Waiting for cinder to start.
openstack volume service list is available:
ssh controller source /home/stack/config/admin-openstackrc.sh; openstack volume service list
+------------------+-------------+------+---------+-------+----------------------------+
| Binary           | Host        | Zone | Status  | State | Updated At                 |
+------------------+-------------+------+---------+-------+----------------------------+
| cinder-scheduler | controller  | nova | enabled | up    | 2020-12-28T06:55:40.000000 |
| cinder-volume    | compute@lvm | nova | enabled | up    | 2020-12-28T06:55:31.000000 |
+------------------+-------------+------+---------+-------+----------------------------+
Waiting for all cinder services to start..
All cinder services seem to be up and running.
ssh controller source /home/stack/config/admin-openstackrc.sh; openstack volume service list
+------------------+-------------+------+---------+-------+----------------------------+
| Binary           | Host        | Zone | Status  | State | Updated At                 |
+------------------+-------------+------+---------+-------+----------------------------+
| cinder-scheduler | controller  | nova | enabled | up    | 2020-12-28T06:55:40.000000 |
| cinder-volume    | compute@lvm | nova | enabled | up    | 2020-12-28T06:55:41.000000 |
+------------------+-------------+------+---------+-------+----------------------------+
Sourcing the demo credentials.
openstack volume create --size 1 volume1
ssh controller source /home/stack/config/demo-openstackrc.sh; openstack volume create --size 1 volume1
+---------------------+--------------------------------------+
| Field               | Value                                |
+---------------------+--------------------------------------+
| attachments         | []                                   |
| availability_zone   | nova                                 |
| bootable            | false                                |
| consistencygroup_id | None                                 |
| created_at          | 2020-12-28T06:55:49.000000           |
| description         | None                                 |
| encrypted           | False                                |
| id                  | b6bb686d-20c7-492b-9358-f4ecfc18294b |
| multiattach         | False                                |
| name                | volume1                              |
| properties          |                                      |
| replication_status  | None                                 |
| size                | 1                                    |
| snapshot_id         | None                                 |
| source_volid        | None                                 |
| status              | creating                             |
| type                | __DEFAULT__                          |
| updated_at          | None                                 |
| user_id             | 44d75be5d9c847e8b792fe838b5fed58     |
+---------------------+--------------------------------------+
Waiting for cinder to list the new volume.
Waiting for cinder volume to become available..
Volume successfully created:
ssh controller source /home/stack/config/demo-openstackrc.sh; openstack volume list
+--------------------------------------+---------+-----------+------+-------------+
| ID                                   | Name    | Status    | Size | Attached to |
+--------------------------------------+---------+-----------+------+-------------+
| b6bb686d-20c7-492b-9358-f4ecfc18294b | volume1 | available |    1 |             |
+--------------------------------------+---------+-----------+------+-------------+
Deleting volume.
ssh controller source /home/stack/config/demo-openstackrc.sh; openstack volume delete volume1
openstack volume list
ssh controller source /home/stack/config/demo-openstackrc.sh; openstack volume list

